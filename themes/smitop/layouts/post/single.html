{{ define "main" }}
  {{ partial "topbar" .Params.topbar_id }}
  <section itemscope itemtype="http://schema.org/Article" id="content">
    <h2 itemprop="name" id="title">{{ .Title }}</h2>
    By <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/#me-links"><span itemprop="name">Smitop</span></a></span> · <span itemprop="datePublished" content="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "Jan 2, 2006" }}</span> · {{ math.Ceil (mul .ReadingTime 1.333) }} minute read
    <div>
      <article itemprop="articleBody" id="content">
        {{ if .Params.toc }}
            {{ .TableOfContents }}
        {{ end }}
        {{ .Content }}
        <div style="margin-bottom: 1rem;">
          You can follow me on <a href="https://twitter.com/_smitop">Twitter</a>, <a href="https://www.youtube.com/channel/UCg9cKCFNaVDYmXK2u-FxX1w">YouTube</a>, and <a href="/p/accounts/">elsewhere</a>.
        </div>
      </article>
    </div>
  </section>
  <aside id="meta">

  {{ with ((.Site.RegularPages.Related .) | first 5) }}
    <div class="related-posts">
      <h2>Related</h2>
      {{ range . }}
        {{ partial "streamitem.html" (dict "Item" .) }}
      {{ end }}
    </div>
  {{ end }}

    <div>
      {{ with .Params.tags }}
        Tags:
        <div id="tags">
          {{ range . }}
          <a href="{{ "tags/" | absURL }}{{ . | urlize }}">{{ . }}</a>,
          {{ end }}
        </div>
      {{ end }}
    </div>
    <div>
      {{ with .PrevInSection }}
        Previous: <a class="previous" href="{{.Permalink}}">{{.Title}}</a>
      {{ end }}
      {{ with .NextInSection }}
        Next: <a class="next" href="{{.Permalink}}">{{.Title}}</a>
      {{ end }}
    </div>
    <div id="remarkbox-div">
      <noscript>
        <iframe id=remarkbox-iframe src="https://my.remarkbox.com/embed?nojs=true" style="height:600px;width:100%;border:none!important" tabindex=0></iframe>
      </noscript>
    </div>
    <script src="https://my.remarkbox.com/static/js/iframe-resizer/iframeResizer.min.js"></script>
    <script>
      var rb_owner_key = "0527ee82-ae72-11ea-94aa-040140774501";
      var thread_uri = window.location.href;
      var thread_title = window.document.title;
      var thread_fragment = window.location.hash;
    
      // rb owner was here.
      var rb_src = "https://my.remarkbox.com/embed" + 
          "?rb_owner_key=" + rb_owner_key +
          "&thread_title=" + encodeURI(thread_title) +
          "&thread_uri=" + encodeURIComponent(thread_uri) + 
          thread_fragment;
    
      function create_remarkbox_iframe() {
        var ifrm = document.createElement("iframe");
        ifrm.setAttribute("id", "remarkbox-iframe");
        ifrm.setAttribute("scrolling", "no");
        ifrm.setAttribute("src", rb_src);
        ifrm.setAttribute("frameborder", "0");
        ifrm.setAttribute("tabindex", "0");
        ifrm.setAttribute("title", "Remarkbox");
        ifrm.style.width = "100%";
        document.getElementById("remarkbox-div").appendChild(ifrm);
      }
      create_remarkbox_iframe();
      iFrameResize(
        {
          checkOrigin: ["https://my.remarkbox.com"],
          inPageLinks: true,
          initCallback: function(e) {e.iFrameResizer.moveToAnchor(thread_fragment)}
        },
        document.getElementById("remarkbox-iframe")
      );
    </script>
    <div id="license-info">
      This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </div>    
  </aside>
{{ end }}
