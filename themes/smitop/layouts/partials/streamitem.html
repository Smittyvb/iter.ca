<div class="stream-item{{if (isset . "Featured")}} featured{{ end }}" id="{{ if (isset .Item "Id")}}stream-item-{{ .Item.Id }}{{ else }}stream-item-post-{{ .Item.File.UniqueID }}{{ end }}">
    {{if (isset . "Featured")}}<img src="/star.svg" class="fstar" alt="Featured" title="Featured" width="20">{{ end }}
    {{ if .Item.Title}}
        <div class="stream-item-type">
    {{ else }}
        <h2 class="stream-item-type">
        {{ if (isset .Item "Uri") }}
            <a href="{{ .Item.Uri }}">
        {{ end }}
    {{ end }}
        {{ if (isset .Item "Type")}}
            {{ if (eq .Item.Type "note")}}
                {{ if (isset .Item "NoteType")}}
                    {{ .Item.NoteType }}
                {{ else }}
                    Note
                {{ end }}
            {{ else if (eq .Item.Type "video")}}
                Video
            {{ else if (eq .Item.Type "hn")}}
                HN {{ .Item.HNType }}
            {{ else if (eq .Item.Type "scrproj")}}
                Scratch project
            {{ else if (eq .Item.Type "SePost")}}
                Stack Exchange post
            {{ else if (eq .Item.Type "itch")}}
                Itch {{ .Item.ItchType }}
            {{ else if (eq .Item.Type "gh-pr")}}
                Pull request
            {{ else }}
                Note
            {{ end }}
        {{ else }}
            Blog post
        {{ end }}
    {{ if .Item.Title}}
        </div>
    {{ else }}
        {{ if (isset .Item "Uri") }}
            </a>
        {{ end }}
        </h2>
    {{ end }}
    {{ if (isset .Item "Type")}}
        {{ if (isset .Item "Title")}}
            <h2>
                {{ if (isset .Item "Uri") }}
                    <a href="{{ .Item.Uri }}">
                {{ end }}
                    {{ .Item.Title }}
                {{ if (isset .Item "Uri") }}
                    </a>
                {{ end }}
            </h2>
        {{ end }}
        <div class="stream-item-date">
            {{ if (eq .Item.Type "gh-pr")}}
                merged
            {{ end }}
            {{ dateFormat "January 2, 2006" (int .Item.Date.Unix) }}
        </div>
        {{ if (isset .Item "Uri") }}
            <a href="{{ .Item.Uri }}">
        {{ end }}
            {{ if (isset .Item "Thumb") }}
                <div class="stream-item-thumb-wrapper">
                    <img
                        src="{{ .Item.Thumb }}"
                        {{ if (eq .Item.Type "itch")}}
                            height="135" width="170.1"
                        {{ else }}
                            height="135" width="240"
                        {{ end }}
                        class="stream-item-thumb"
                        loading="lazy" />
                </div>
            {{ end }}
        {{ if (isset .Item "Uri") }}
            </a>
        {{ end }}
        {{ if (isset .Item "Text") }}
            <!-- safeHTML is okay here since this content is all generated by me -->
            <div class="summary">
                {{ if (eq .Item.Type "note") }}
                    {{ .Item.Text | safeHTML }}
                {{ else if (eq .Item.Type "hn")}}
                    {{ .Item.Text | safeHTML | truncate 150 }}
                {{ else }}
                    {{ .Item.Text | truncate 150 | markdownify | plainify | htmlUnescape | safeHTML }}
                {{ end }}
            </div>
        {{ end }}
    {{ else }}
        <div>
            <h2>
                <a href="{{.Item.Permalink}}">{{.Item.Title}} {{ if (.Item.Draft) }}(DRAFT){{end}}</a>
            </h2>
            <div class="stream-item-date">{{ .Item.Date.Format "January 2, 2006" }}</div>
            <div class="summary">
                {{ .Item.Description }}
                <a class="cont-reading" href="{{.Item.Permalink}}">(continue reading)</a>
            </div>
        </div>
    {{ end }}
</div>
